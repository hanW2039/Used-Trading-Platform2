<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<title>乐淘淘-良品区</title>
	<link rel="stylesheet" th:href="@{/css/book.css}">
</head>

<body>
	<!-- 导航 -->
	<header>
		<nav class="navbar">
			<div class="nav-info">
				<a th:href="@{/myBookSelf}" class="username" th:if="${loginUser!=null}" th:text="${loginUser.phone}">你的名字</a>
				<a th:href="@{/login}" class="username" th:if="${loginUser==null}">登录</a>
				<!--			<a th:href="@{/myBookSelf}" class="bookshelf" th:if="${loginUser!=null}">||&nbsp;&nbsp;&nbsp;我的小摊</a>-->
				<a th:href="@{/register}" class="bookshelf" th:if="${loginUser==null}">||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注册</a>
				<a th:href="@{/shopping_cart}" class="bookshelf" th:if="${loginUser!=null}">||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;购物车</a>
				<a th:href="@{/logout}" class="logout" th:if="${loginUser!=null}">[ 退 出 ]</a>
			</div> <!-- nav-info -->
			<div class="nav-search">
				<a href="#"><img class="logo" th:src="@{/img/logo2.png}"></a>
				<div class="search-form">
					<form th:action="@{/store}" method="get">
						<input type="search" class="searchIn" placeholder="搜商品..." name="name">
						<a href="#" class="search-logo">| &nbsp;<img th:src="@{/img/search.png}"></a>
						<button type="submit" class="searchBtn"><a href="#">搜索</a></button>
					</form>
				</div>
			</div><!--  nav-search -->
			<ul class="menu">
				<li><a th:href="@{/index}">首页</a></li>
				<li><a class="active" th:href="@{/store}">良品区</a></li>
				<li><a th:href="@{/askBook}">求购区</a></li>
			</ul>
		</nav>
		<div class="bookstore-pic"></div>
	</header>
	<!-- 图书分类 -->
	<div id="container">
<!--		<div id="book-menu">-->
<!--			<ul class="book-class">-->
<!--				<li><a href="#article" title="article">小说 / 文学 / 语言文字</a></li>-->
<!--				<li><a href="#">历史 / 地理 / 艺术</a></li>-->
<!--				<li><a href="#">政治 / 法律 / 军事</a></li>-->
<!--				<li><a href="#">哲学 / 心理 / 宗教</a></li>-->
<!--				<li><a href="#">经济 / 社科 / 综合</a></li>-->
<!--				<li><a href="#">童书 / 生活 / 体育</a></li>-->
<!--				<li><a href="#">教材 / 教辅 / 考试</a></li>-->
<!--				<li><a href="#">工程技术 / 互联网</a></li>-->
<!--				<li><a href="#">自然科学 / 医药卫生</a></li>-->
<!--			</ul>-->
<!--		</div>-->
<!--		<div id="book-menu-toggle">-->
<!--			查 看 菜 单-->
<!--			<div id="toggle-btn"></div>-->
<!--		</div>-->
		<div id="book-container">
			<h3 class="book-title"><a href="#">| 所有商品</a></h3>
			<ul class="book-lists">
				<li class="book-list" th:each="shop:${shopList}">
					<input type="hidden" name="shopid" id="shopid" th:value="${shop.id}">
					<a class="book-pic">
						<img th:src="${shop.image}">
					</a>
					<a th:href="@{/detail/(id=${shop.id})}" class="book-info">
<!--						<input type="hidden" name="id" th:value="${shop.id}">-->
						<h5 class="book-name" th:text="${shop.name}">白夜行</h5>
						<span class="book-detail" th:text="${shop.remark}">东野圭吾 著 / 南海出版公司 / 2008-09 / 平装</span>
					</a>
					<span class="book-price"><a th:utext="${shop.price}">12</a>
<!--						<a th:href="@{/addCar/(id=${shop.id})}" class="book-buy">加入购物车</a>-->
						<button  onclick="add()"><a class="book-buy">加入购物车</a></button>
					</span>
				</li>
			</ul><!--  book-list end -->
		</div> <!-- book-container end-->
		<span class="page-btn"  th:if="${page.rows>0}" th:fragment="pagination">

			<a class="page-top" th:href="@{${page.path}(current=1)}">首页</a>
			<a class="page-pre" th:href="@{${page.path}(current=${(page.current)-1})}">上一页</a>
			<a class="page-pre" th:href="@{${page.path}(current=${(page.current)+1})}">下一页</a>
			<a class="page-end" th:href="@{${page.path}(current=${page.total})}">尾页</a>
		</span>
	</div><!-- container end-->

	<script type="text/javascript" th:src="@{/js/jquery-3.2.js}"></script>
	<script>
		function add() {
			var shopId = document.getElementById("shopid");
			var id = shopId.value;
			var xhr = new XMLHttpRequest();
			xhr.open('POST', '/addToCar', false);
			xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
			xhr.send(JSON.stringify(id));

			if (xhr.status === 200) {
				 alert('添加成功');
			} else {
			   var url = "login"
         	   window.location.href = nextPageUrl;
			}
        }
	</script>
	<script type="text/javascript">
		$(function () {
			//菜单特效
			var index = 0
			$("#book-menu-toggle").on("click", function () {
				if (index === 0) {
					$("#book-menu").css("left", "1px");
					$(this).css("left", "178px");
					index = 1;
				} else {
					$("#book-menu").css("left", "-180px");
					$(this).css("left", "1px");
					index = 0;
				}
			});

			//点击菜单，对应类别颜色加深
			$(".book-class li").on("click", function () {
				//加粗当前点击的li
				$(this).css("font-weight", "600").siblings("li").css("font-weight", "500");
			});
		})
	</script>
</body>

</html>